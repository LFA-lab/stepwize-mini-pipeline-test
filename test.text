STEPWIZE MINI PIPELINE - COMPREHENSIVE TEST SUITE


Total Points: 100
- Token validation and input checks (401/422): 25 points
- Both modes working (file upload + URL): 25 points  
- Callback JSON received and stored: 20 points
- HTML page displays the steps: 20 points
- Clear documentation (README with setup & tests): 10 points

Check services are running:
curl http://localhost:8000/health
curl http://localhost:4000/health

1. TOKEN VALIDATION AND INPUT CHECKS (25 points)
===============================================

1.1 Missing Authorization Header (should return 401)
----------------------------------------------------
curl -w "Status: %{http_code}\n" -X POST http://localhost:8000/process-video \
  -H "Content-Type: application/json" \
  -d '{"video_url":"https://example.com/video.mp4","guide_id":67,"callback_url":"http://callback:4000/callbacks/steps"}'

Expected: HTTP 401 Unauthorized

1.2 Invalid Authorization Token (should return 401)
---------------------------------------------------
curl -w "Status: %{http_code}\n" -X POST http://localhost:8000/process-video \
  -H "Authorization: Bearer invalid_token" \
  -H "Content-Type: application/json" \
  -d '{"video_url":"https://example.com/video.mp4","guide_id":67,"callback_url":"http://callback:4000/callbacks/steps"}'

Expected: HTTP 401 Unauthorized

1.3 Missing guide_id (should return 422)
-----------------------------------------
curl -w "Status: %{http_code}\n" -X POST http://localhost:8000/process-video \
  -H "Authorization: Bearer stepwize_test" \
  -H "Content-Type: application/json" \
  -d '{"video_url":"https://example.com/video.mp4","callback_url":"http://callback:4000/callbacks/steps"}'

Expected: HTTP 422 Invalid input

1.4 Missing callback_url (should return 422)
---------------------------------------------
curl -w "Status: %{http_code}\n" -X POST http://localhost:8000/process-video \
  -H "Authorization: Bearer stepwize_test" \
  -H "Content-Type: application/json" \
  -d '{"video_url":"https://example.com/video.mp4","guide_id":67}'

Expected: HTTP 422 Invalid input

1.5 Missing video source (should return 422)
---------------------------------------------
curl -w "Status: %{http_code}\n" -X POST http://localhost:8000/process-video \
  -H "Authorization: Bearer stepwize_test" \
  -H "Content-Type: application/json" \
  -d '{"guide_id":67,"callback_url":"http://callback:4000/callbacks/steps"}'

Expected: HTTP 422 Invalid input

2. BOTH MODES WORKING (25 points)
=================================

2.1 URL Mode - JSON Input (should return 200 with 3 steps)
-----------------------------------------------------------
curl -w "Status: %{http_code}\n" -X POST http://localhost:8000/process-video \
  -H "Authorization: Bearer stepwize_test" \
  -H "Content-Type: application/json" \
  -d '{"video_url":"https://example.com/sample-video.mp4","guide_id":67,"callback_url":"http://callback:4000/callbacks/steps"}'

Expected: HTTP 200 with JSON response containing:
- guide_id: 67
- steps: array with 3 items
- Each step has: index, second, title, image_url

2.2 File Upload Mode - Multipart Form Data (should return 200 with 3 steps)
-----------------------------------------------------------------------------
curl -w "Status: %{http_code}\n" -X POST http://localhost:8000/process-video \
  -H "Authorization: Bearer stepwize_test" \
  -F "file=@/Users/karanchoudhary/Developer/Anantam/public/videos/feature-2.mp4" \
  -F "guide_id=67" \
  -F "callback_url=http://callback:4000/callbacks/steps"

Expected: HTTP 200 with JSON response containing:
- guide_id: 67
- steps: array with 3 items
- Each step has: index, second, title, image_url

3. CALLBACK JSON RECEIVED AND STORED (20 points)
===============================================

# Check if data was stored
cat interface/received.json

4. HTML PAGE DISPLAYS THE STEPS (20 points)
===========================================

4.1 View guide page in browser
-------------------------------
# Open in browser
open http://localhost:4000/guides/67

# Or get HTML with curl
curl -w "Status: %{http_code}\n" http://localhost:4000/guides/67

Expected: 
- HTTP 200 status
- HTML page with title "Guide 67"
- Contains step cards with titles and images
- Responsive design with CSS styling
- Shows "Test Frame 1", "Test Frame 2", "Test Frame 3"

4.2 Test non-existent guide (should return 404)
------------------------------------------------
curl -w "Status: %{http_code}\n" http://localhost:4000/guides/999

Expected: HTTP 404 with error message

5. CLEAR DOCUMENTATION (10 points)
==================================

5.1 README.md contains:
-----------------------
✅ Project overview and architecture
✅ Complete setup instructions
✅ API documentation with examples
✅ Testing procedures
✅ Docker configuration details
✅ Troubleshooting guide
✅ Feature checklist
✅ Grading breakdown

VERIFICATION CHECKLIST
======================

□ All 401 tests return Unauthorized
□ All 422 tests return Unprocessable Entity  
□ JSON mode returns 200 with 3 steps
□ File upload mode returns 200 with 3 steps
□ Callback endpoint stores data in received.json
□ HTML page displays steps with proper styling
□ Guide 999 returns 404
□ Health endpoints return {"ok": true}
□ README.md is comprehensive and clear

END OF TEST SUITE
